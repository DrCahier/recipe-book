<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>レシピアプリ</title>
    <!-- Google Identity Services (OAuth2) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/assets/img/icn/192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="/assets/img/icn/512.png" sizes="512x512">
    <link rel="stylesheet" href="/assets/css/style.css">
    <meta name="theme-color" content="#ffffff">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><text y='52' font-size='52'>🍳</text></svg>">
</head>
<body>
<header class="l-header">
    <!-- ← お気に入りフィルタON時だけ表示する戻るボタン -->
    <a id="backFromFavs" class="btn -ghost" href="/" hidden>← 戻る</a>

    <h1 class="app-title"><a href="/" class="home-link" aria-label="ホームへ">レシピ</a></h1>

    <div class="search">
        <input id="q" type="search" placeholder="レシピを検索…" autocomplete="off" aria-label="レシピを検索">
    </div>

    <!-- 並び替え -->
    <label class="sortwrap" aria-label="並び替え">
        <span class="sortlabel">並び</span>
        <select id="sortSel" class="sortsel" aria-label="並び替え">
            <option value="">デフォルト</option>
            <option value="title_asc">タイトル A→Z</option>
            <option value="time_asc">時間 短い順</option>
            <option value="time_desc">時間 長い順</option>
        </select>
    </label>
    <label class="chkwrap" title="お気に入りを上に表示">
        <input id="favFirstChk" type="checkbox" aria-label="お気に入りを上に"> ★上に
    </label>

    <!-- お気に入りフィルタ -->
    <button id="favFilterBtn" class="btn -ghost" aria-pressed="false" title="お気に入りだけ表示">
        ★ お気に入り <span id="favCount" aria-live="polite"></span>
    </button>

    <!-- タグ一覧ページへ -->
    <a id="navTags" class="btn -ghost" href="/?v=tags" aria-label="タグ一覧"># タグ</a>
</header>

<main class="l-main" id="main">

    <!--ドライブセクション-->
    <section class="c-card" id="drive-section" aria-labelledby="drive-heading">
        <h2 id="drive-heading" class="c-card__title">Google Drive</h2>
        <div class="c-card__body">
            <div class="c-actions" style="gap:.5rem; display:flex; flex-wrap:wrap; align-items:center;">
                <button id="drive-connect" class="btn">Driveに接続</button>
                <!-- （保存先UIを使っているならそれはそのまま。旧UIなら省略可） -->
                <button id="drive-pick-folder" class="btn -ghost" disabled>保存先フォルダを選ぶ</button>

                <button id="drive-import" class="btn -ghost" disabled>Driveから取り込み</button>
                <button id="drive-sync" class="btn" disabled>Driveと同期</button>
            </div>


            <p class="c-help">
                例）<code>RecipeApp/recipes</code> ／ 既存フォルダIDを使う場合は
                <code>id:1AbCdefGh...</code>
            </p>
            <div id="drive-result" class="c-note" aria-live="polite"></div>
        </div>
    </section>
    <!--/ドライブセクション-->


    <!-- 追加：インポート／エクスポート -->
    <section class="c-card" id="io-section" aria-labelledby="io-heading">
        <h2 id="io-heading" class="c-card__title">インポート／エクスポート</h2>
        <div class="c-card__body">
            <div class="c-actions">
                <button id="export-json" class="btn">JSONを書き出す</button>
                <button id="import-json" class="btn -ghost">JSONを読み込む</button>
                <input id="import-file" type="file" accept="application/json" hidden>
            </div>
            <p class="c-help">※ 書き出しは .json。読み込みは当アプリの書き出し形式のみ対応。</p>
            <div id="io-result" class="c-note" aria-live="polite"></div>
        </div>
    </section>

    <!-- 一覧ページ -->
    <section id="page-list" aria-labelledby="list-heading">
        <h2 id="list-heading" class="visually-hidden">レシピ一覧</h2>
        <ul id="recipe-list" class="recipe-list" role="list" aria-live="polite"></ul>
        <div id="empty" class="empty" hidden>
            該当するレシピがありません。<br>
            <span id="emptyHint" style="font-size:.9rem;color:#999"></span>
        </div>
    </section>

    <!-- 詳細ページ -->
    <section id="page-detail" hidden aria-labelledby="detail-heading">
        <nav class="breadcrumb">
            <a href="/" id="backLink" class="btn -ghost" aria-label="一覧に戻る">← 一覧へ戻る</a>
        </nav>
        <article class="detail">
            <header>
                <h2 id="detail-heading" class="detail__title"></h2>
                <p class="meta"><span id="d-time"></span> / <span id="d-tags"></span></p>
                <button id="favToggleDetail" class="fav-btn" aria-pressed="false" title="お気に入りに追加">☆ お気に入り</button>
            </header>
            <section>
                <h3>材料</h3>
                <ul id="d-ingredients" class="bullets"></ul>
            </section>
            <section>
                <h3>手順</h3>
                <ol id="d-steps" class="steps"></ol>
            </section>
        </article>
    </section>

    <!-- タグ一覧ページ -->
    <section id="page-tags" hidden aria-labelledby="tags-heading">
        <nav class="breadcrumb">
            <a href="/" id="backFromTags" class="btn -ghost" aria-label="一覧に戻る">← 一覧へ戻る</a>
        </nav>
        <h2 id="tags-heading">タグ一覧</h2>
        <p id="tagStats" class="meta"></p>
        <ul id="tag-list" class="tag-list" role="list"></ul>
        <div id="tag-empty" class="empty" hidden>タグがありません。</div>
    </section>
</main>

<noscript>このアプリを使うには JavaScript を有効にしてください。</noscript>
<!-- Google API (Picker用) をまだ入れてなければ追加 -->
<script src="https://apis.google.com/js/api.js" async defer></script>

<!-- 分割版 Drive モジュール -->
<script type="module" src="/assets/js/drive/index.js"></script>
<script src="/app.js" defer></script>
<!-- 追加：入出力モジュール -->
<script src="/assets/js/io.js" defer></script>
</body>
</html>
