<!DOCTYPE html>
.hint{ font-size:12px; color:var(--muted); margin-top:12px; }
.row{ display:flex; gap:8px; flex-wrap:wrap; }
.btn{ appearance:none; border:1px solid #e5e7eb; background:#fff; color:#111; border-radius:999px; padding:10px 14px; font-weight:700; cursor:pointer; }
.btn.-primary{ background:var(--accent); color:#fff; border-color:transparent; }
.list{ display:grid; gap:10px; margin-top:10px; }
.card{ border:1px dashed #e5e7eb; border-radius:12px; padding:12px; background:#f9fafb; }
.skeleton{ height:14px; background:#e5e7eb; border-radius:8px; margin:6px 0; }
</style>
</head>
<body>
<main class="wrap" role="main" aria-labelledby="ttl">
    <h1 id="ttl">オフラインです</h1>
    <p>ネットワークに接続できません。キャッシュ済みのレシピは引き続きご覧いただけます。</p>


    <div class="row">
        <button class="btn -primary" onclick="location.reload()">再読み込み</button>
        <button class="btn" onclick="history.back()">前の画面に戻る</button>
    </div>


    <section aria-labelledby="cached-ttl" style="margin-top:16px;">
        <h2 id="cached-ttl" style="font-size:16px; margin:0 0 6px;">キャッシュ済みの候補</h2>
        <div id="cachedList" class="list" aria-live="polite">
            <div class="card"><div class="skeleton" style="width:60%"></div><div class="skeleton" style="width:40%"></div></div>
            <div class="card"><div class="skeleton" style="width:70%"></div><div class="skeleton" style="width:30%"></div></div>
        </div>
        <p class="hint">※ 初回アクセス前のページはキャッシュに含まれない場合があります。</p>
    </section>
</main>
<script>
    // 簡易：Cache Storage から index.html と画像などのキーを拾って表示（対応ブラウザ用）
    (async () => {
        if (!('caches' in window)) return;
        try {
            const keys = await caches.keys();
            const cache = await caches.open(keys[keys.length - 1]); // 最新を仮定
            const reqs = await cache.keys();
            const container = document.getElementById('cachedList');
            container.innerHTML = '';
            reqs
                .map(r => r.url)
                .filter(u => /\/recipe\//.test(u) || /index\.html$/.test(u))
                .slice(0,6)
                .forEach(u => {
                    const div = document.createElement('div');
                    div.className = 'card';
                    const path = new URL(u).pathname;
                    div.innerHTML = `<strong>${path}</strong><div class="hint">キャッシュから開く可能性あり</div>`;
                    container.appendChild(div);
                });
            if (!container.children.length) {
                container.innerHTML = '<div class="card">キャッシュ済みのページが見つかりませんでした。</div>';
            }
        } catch (e) {
            console.warn('cache list failed', e);
        }
    })();
</script>
<noscript>JavaScriptを有効にすると、キャッシュ済みページの候補が表示されます。</noscript>
</body>
</html>